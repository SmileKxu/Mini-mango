#  工作日记

## 2017.7.11日记

* 今天看了session代码，还是不是很清楚，在其他路由文件中使用session代码

* 还完成了部分的个人页面的一部分 

* 明天完成个人主页，并给他添加事件，与组员构思后台路由的搭建

## 2017.7.12日记
* 理解了sesion，并能够会使用
* 先在app.js文件前边引用session
* session是全局变量
```js
app.use(session({
  resave: true,
  saveUninitialized: false,
  secret: 'secret',
  cookie: {
    maxAge: 1000*60*30
  }
}));
```

* 再次完善了个人主页一部份，并构思了路由的流程

* 明日任务，分配路由任务给组员，把主页再次完善

## 2017.7.13日记

数据库的使用方法

```js
Model.$where

有时我们需要在 MongoDB 中使用 JavaScript 表达式进行查询，这时可以用 find({$where : javascript}) 方式，$where 是一种快捷方式，并支持链式调用查询。

Model.$where('this.firstname === this.lastname').exec(callback)
Model.update

使用 update 子句更新符合指定条件的文档，更新数据在发送到数据库服务器之前会改变模型的类型。

var conditions = { name: 'borne' }
  , update = { $inc: { visits: 1 }}
  , options = { multi: true };

Model.update(conditions, update, options, callback)

```

密码加密 加盐

```js
var express = require('express');
var bcrypt = require('bcrypt');
var router = express.Router();
var db = require('../db');
var salt = 10;   // 加盐:避免因多个人密码相同使计算后的hash相同, 可任意设置值

router.post('/', (req, res, next) => {
  bcrypt.hash(req.body.password, salt, (err, hash) => { 通过加盐对密码加密
    var user = new db.user({
      name: req.body.name,
      password: hash
    });
    user.save((err, data) => {
      res.redirect('/');
    });
  });

});
```

明日任务链接个人主页到数据库  并把所有路由都链接起来

## 2017.7.17 

今天的完成了整个项目的流程 基本的各个功能都实现了

数据，路由也没有任何冲突 今天了解到了a标签的一些属性

还有使用ajax页面的跳转，与a标签的结合，完美跳转

```js
<a id="btn" href="/"></a>
$(".btn").click(function(event) {
if ((title == "") || (ooo == "") || (taggg == "")) {
alert("所有输入框的内容均不能为空!!!");
event.preventDefault();
return false;
}				
// console.log(con);
$("#header-font-weight").click();
$.ajax({
url: "/questions",
data: con,
type: "post",
dataType: 'json',
traditional: true
}).then(function(data, textStatus, jqXHR) {
console.log("success");
// window.location = "http://127.0.0.1:3000/login";
}, function(jqXHR, textStatus, errorThrown) {
console.log(textStatus);
//  alert("提问成功");
});
// event.stopPropagation();
});
```
jquery find()函数的使用

得到相同的span里面的值，
返回的是一个数组，使用eq(i)可以得到数组里面的值；
```js
var lis = $("li").find("span");
for(var i = 0;i<lis.lenght;i++){
(function(i){
lis.eq(i);
})(i);
}
```
根据id插入数据

```js
questions.findByIdAndUpdate(str,{$inc:{scans:1}},function (err,data) {

  });
```
今天晚上并没有将大家的今天写代码没有整合到一起；
明天如果老师不讲新课，那就先将东西整合到一起 ，再次调试，解决bug
实现新的功能，付费系统功能 就先这样，
并将我的页面上最后的功能实现了，解决个人主页的bug

